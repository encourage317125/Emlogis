<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.4.0.v20150206-1039 Build &lt;4.2.3.v20150206-1039></property>
    <property name="units">in</property>
    <method name="initialize"><![CDATA[try {
	emlogis.current.reportName = "Daily Demand Curve and Shift Solution";
	
	reportContext.setGlobalVariable("reportData", {});
	
} catch(e){};]]></method>
    <property name="theme">common.EmlogisGrayScales</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="layoutPreference">auto layout</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">/ThemesReportItems31.rptlibrary</property>
            <property name="namespace">ThemesReportItems31</property>
        </structure>
        <structure>
            <property name="fileName">emlogis/report-libs/common.RPTLIBRARY</property>
            <property name="namespace">common</property>
        </structure>
        <structure>
            <property name="fileName">emlogis/report-libs/debug.rptlibrary</property>
            <property name="namespace">debug</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="restApiUrl" id="43" extends="common.restApiUrl"/>
        <scalar-parameter name="StartDate" id="10805" extends="common.StartDate">
            <text-property name="promptText">Date</text-property>
            <property name="valueType">static</property>
            <property name="dataType">date</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="javascript">new Date()</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <cascading-parameter-group name="BasicReportCascadingParameterGroup" id="13993" extends="common.BasicReportCascadingParameterGroup">
            <overridden-values>
                <ref-entry baseId="11074" name="Security" id="11074"/>
                <ref-entry baseId="11075" name="Site" id="11075"/>
                <ref-entry baseId="14682" name="Teams" id="14682"/>
            </overridden-values>
        </cascading-parameter-group>
    </parameters>
    <data-sources>
        <script-data-source name="Data Source" id="4" extends="common.Data Source"/>
    </data-sources>
    <data-sets>
        <script-data-set name="Site DS" id="5" extends="common.Site DS"/>
        <script-data-set name="Team DS" id="6" extends="common.Team DS"/>
        <script-data-set name="Dates Range DS" id="7" extends="common.Dates Range DS"/>
        <script-data-set name="Time Interval DS" id="8">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">startTimeMillis</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">startTime12</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">durationMillis</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">endTimeMillis</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">endTime12</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">joinColumn</property>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">startTimeMillis</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">startTime12</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">durationMillis</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">endTimeMillis</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">endTime12</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">joinColumn</property>
                    <property name="analysis">measure</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">totalDurationHours</property>
                    <property name="dataType">integer</property>
                    <property name="position">1</property>
                    <expression name="defaultValue" type="javascript">24</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">intervalDurationMillis</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <expression name="defaultValue" type="javascript">"1800000" //30 min</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">startTimeMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">startTime12</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">durationMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">endTimeMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">endTime12</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">joinColumn</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <method name="open"><![CDATA[var totalDurationHours = inputParams["totalDurationHours"];
intervalDurationMillis = emlogis.helper.toNumber(inputParams["intervalDurationMillis"]);

if(isNaN(intervalDurationMillis)) { 
	throw "TimeIntervals DS:open Invalid 'intervalDurationMillis' value " + inputParams["intervalDurationMillis"];
}

intervalsCount = 0;
intervalsAmount = Math.round(hoursToMillis(totalDurationHours)/intervalDurationMillis);

currentIntervalStartTimeMillis = 0;

function hoursToMillis(hours) {
	return hours * 60 * 60 * 1000;
}]]></method>
            <method name="fetch"><![CDATA[if(intervalsCount < intervalsAmount) {
	var startTimeMillis = currentIntervalStartTimeMillis;
	var endTimeMillis = startTimeMillis + intervalDurationMillis;
	
	row["startTimeMillis"] = startTimeMillis;
	row["startTime12"] = emlogis.date.timeObjectToShort12TimeString(emlogis.date.millisToTime(startTimeMillis));
	row["durationMillis"] = intervalDurationMillis;
	row["endTimeMillis"] = endTimeMillis;
	row["endTime12"] = emlogis.date.timeObjectToShort12TimeString(emlogis.date.millisToTime(endTimeMillis));
	
	/*
     * Used for joining everything to everything. 
     * For example we want to join employees and DS which represents 7 days of week:
     * using leftOuterJoin every employee will be duplicated 7 times, 
     * each duplication with different day of the week
     */
	row["joinColumn"] = 1;
	
	currentIntervalStartTimeMillis = endTimeMillis;
	intervalsCount++;
	return true;
}
return false;]]></method>
        </script-data-set>
        <script-data-set name="Shift Demand DS" id="10804">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">id</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">startTime</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">lengthInMin</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">employeeCount</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">shiftPatternId</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">teamId</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">skillId</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">dayOfWeek</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">cdDate</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">maxEmployeeCount</property>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">id</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">startTime</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">lengthInMin</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">employeeCount</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">shiftPatternId</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">teamId</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">skillId</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">dayOfWeek</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">cdDate</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">maxEmployeeCount</property>
                    <property name="analysis">measure</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">id</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">startTime</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">lengthInMin</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">employeeCount</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">shiftPatternId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">teamId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">skillId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">dayOfWeek</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">cdDate</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">maxEmployeeCount</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <method name="open"><![CDATA[shiftDemandCount = 0;

try {
	shiftDemandList = reportContext.getPersistentGlobalVariable("shiftDemandList");
}catch(e){
	shiftDemandList = null;
}

if (token &amp;&amp; !shiftDemandList) {
	var date = toServerTime(params["StartDate"].value.getTime()).getTime();
	shiftDemandList = report.getList(token, "teams/shiftdemands?teamIds=" 
		+ emlogis.current.teams.getIds().join(";") + "&amp;date=" + date);
	reportContext.setPersistentGlobalVariable("shiftDemandList", shiftDemandList);
}]]></method>
            <method name="fetch"><![CDATA[if(shiftDemandCount < shiftDemandList.size()) {
	var obj = shiftDemandList.get(shiftDemandCount);
	
	row["id"] = obj.id;
	row["startTime"] = obj.startTime;
	row["lengthInMin"] = obj.lengthInMin;
	row["employeeCount"] = obj.employeeCount;
	row["shiftPatternId"] = obj.shiftPatternId;
	row["teamId"] = obj.teamId;
	row["skillId"] = obj.skillId;
	row["dayOfWeek"] = obj.dayOfWeek;
	row["cdDate"] = obj.cdDate+"";
	row["maxEmployeeCount"] = obj.maxEmployeeCount;
	
	shiftDemandCount++;
	return true;
}
return false;]]></method>
        </script-data-set>
        <script-data-set name="Skill DS" id="10870" extends="common.Skill DS"/>
        <script-data-set name="SelectedTeamsDS" id="10871" extends="common.SelectedTeamsDS"/>
        <derived-data-set extensionID="com.actuate.birt.data.join" name="Teams Skills TimeInterval ShiftDemand Joined DS" id="10872">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">teamName</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">skillName</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">id</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">startTime</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">lengthInMin</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">employeeCount</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">shiftPatternId</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">dayOfWeek</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">cdDate</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">maxEmployeeCount</property>
                    <property name="analysis">measure</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">teamIds</property>
                    <property name="dataType">string</property>
                    <property name="position">1</property>
                    <expression name="defaultValue">emlogis.current.teams.getIds().join(";")</expression>
                    <property name="isOptional">false</property>
                    <property name="allowNull">false</property>
                    <property name="isInput">true</property>
                </structure>
                <structure>
                    <property name="name">totalDurationHours</property>
                    <property name="dataType">integer</property>
                    <property name="position">2</property>
                    <expression name="defaultValue">24</expression>
                    <property name="isOptional">false</property>
                    <property name="allowNull">false</property>
                    <property name="isInput">true</property>
                </structure>
                <structure>
                    <property name="name">intervalDurationMillis</property>
                    <property name="dataType">string</property>
                    <property name="position">3</property>
                    <expression name="defaultValue">"1800000" //30 min</expression>
                    <property name="isOptional">false</property>
                    <property name="allowNull">false</property>
                    <property name="isInput">true</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">teamName</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">skillName</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">skillId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">teamId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">startTimeMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">startTime12</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">durationMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">endTimeMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">endTime12</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">id</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">startTime</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">lengthInMin</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">employeeCount</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">shiftPatternId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">dayOfWeek</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">cdDate</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">maxEmployeeCount</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <method name="onFetch"><![CDATA[var team = row["teamId"];
var skill = row["skillId"];
var timeInterval = row["startTimeMillis"];

var reportData = reportContext.getGlobalVariable("reportData");

var assignCellData = function(){
	
	if(!reportData[team][skill][timeInterval]){
		reportData[team][skill][timeInterval] = {
			demands:[],
			startTimeMillis: row["startTimeMillis"],
			startTime12: row["startTime12"],
			endTimeMillis: row["endTimeMillis"],
			endTime12: row["endTime12"],
			durationMillis: row["durationMillis"]
		};
	}
	
	var currentCell = reportData[team][skill][timeInterval];
	
	if(row["id"]) {
		currentCell.demands.push({
			id: row["id"],
			startTime: row["startTime"],
			lengthInMin: row["lengthInMin"],
			employeeCount: row["employeeCount"],
			shiftPatternId: row["shiftPatternId"],
			maxEmployeeCount: row["maxEmployeeCount"]
		});
	}
}

/**
 * Fill needed properties of the object if it is undefined AND assign corresponding cell reportData
 */
if(reportData[team]) {
	if(reportData[team][skill]){
		assignCellData();
	} else {
		reportData[team][skill] = {};
		assignCellData();
	}
} else {
	reportData[team] = {};
	reportData[team][skill] = {};
	assignCellData();
}]]></method>
            <simple-property-list name="inputDataSets">
                <value>SelectedTeamsDS</value>
                <value>Skill TimeInterval Joined DS</value>
                <value>Shift Demand DS</value>
            </simple-property-list>
            <xml-property name="queryText"><![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<tns:joinedDataSet xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://schemas.actuate.com/birt/dataset_join.xsd" xmlns:tns="http://schemas.actuate.com/birt/dataset_join.xsd">
<tns:selectColumns>
<tns:Column>SelectedTeamsDS::teamName</tns:Column>
<tns:Column>Skill TimeInterval Joined DS::skillName</tns:Column>
<tns:Column>Skill TimeInterval Joined DS::skillId</tns:Column>
<tns:Column>Skill TimeInterval Joined DS::teamId</tns:Column>
<tns:Column>Skill TimeInterval Joined DS::startTimeMillis</tns:Column>
<tns:Column>Skill TimeInterval Joined DS::startTime12</tns:Column>
<tns:Column>Skill TimeInterval Joined DS::durationMillis</tns:Column>
<tns:Column>Skill TimeInterval Joined DS::endTimeMillis</tns:Column>
<tns:Column>Skill TimeInterval Joined DS::endTime12</tns:Column>
<tns:Column>Shift Demand DS::id</tns:Column>
<tns:Column>Shift Demand DS::startTime</tns:Column>
<tns:Column>Shift Demand DS::lengthInMin</tns:Column>
<tns:Column>Shift Demand DS::employeeCount</tns:Column>
<tns:Column>Shift Demand DS::shiftPatternId</tns:Column>
<tns:Column>Shift Demand DS::dayOfWeek</tns:Column>
<tns:Column>Shift Demand DS::cdDate</tns:Column>
<tns:Column>Shift Demand DS::maxEmployeeCount</tns:Column>
</tns:selectColumns>
<tns:joins>
<tns:startingDataSet Index="0" name="SelectedTeamsDS"/>
<tns:join>
<tns:type>inner</tns:type>
<tns:dataSet Index="1" name="Skill TimeInterval Joined DS"/>
<tns:on>
<tns:condition>
<tns:leftColumn>SelectedTeamsDS::teamId</tns:leftColumn>
<tns:rightColumn>Skill TimeInterval Joined DS::teamId</tns:rightColumn>
<tns:operator>eq</tns:operator>
</tns:condition>
</tns:on>
</tns:join>
<tns:join>
<tns:type>leftOuter</tns:type>
<tns:dataSet Index="2" name="Shift Demand DS"/>
<tns:on>
<tns:condition>
<tns:leftColumn>Skill TimeInterval Joined DS::skillId</tns:leftColumn>
<tns:rightColumn>Shift Demand DS::skillId</tns:rightColumn>
<tns:operator>eq</tns:operator>
</tns:condition>
<tns:condition>
<tns:leftColumn>Skill TimeInterval Joined DS::teamId</tns:leftColumn>
<tns:rightColumn>Shift Demand DS::teamId</tns:rightColumn>
<tns:operator>eq</tns:operator>
</tns:condition>
<tns:condition>
<tns:leftColumn>Skill TimeInterval Joined DS::startTimeMillis</tns:leftColumn>
<tns:rightColumn>Shift Demand DS::startTime</tns:rightColumn>
<tns:operator>le</tns:operator>
</tns:condition>
<tns:condition>
<tns:leftColumn>Skill TimeInterval Joined DS::endTimeMillis</tns:leftColumn>
<tns:rightColumn>Shift Demand DS::startTime</tns:rightColumn>
<tns:operator>gt</tns:operator>
</tns:condition>
</tns:on>
</tns:join>
</tns:joins>
</tns:joinedDataSet>]]></xml-property>
        </derived-data-set>
        <derived-data-set extensionID="com.actuate.birt.data.join" name="Skill TimeInterval Joined DS" id="10950">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">skillName</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">skillId</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">teamId</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">startTimeMillis</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">startTime12</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">durationMillis</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">endTimeMillis</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">endTime12</property>
                    <property name="analysis">dimension</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">teamIds</property>
                    <property name="dataType">string</property>
                    <property name="position">1</property>
                    <expression name="defaultValue">emlogis.current.teams.getIds().join(";")</expression>
                    <property name="isOptional">false</property>
                    <property name="allowNull">false</property>
                    <property name="isInput">true</property>
                </structure>
                <structure>
                    <property name="name">totalDurationHours</property>
                    <property name="dataType">integer</property>
                    <property name="position">2</property>
                    <expression name="defaultValue">24</expression>
                    <property name="isOptional">false</property>
                    <property name="allowNull">false</property>
                    <property name="isInput">true</property>
                </structure>
                <structure>
                    <property name="name">intervalDurationMillis</property>
                    <property name="dataType">string</property>
                    <property name="position">3</property>
                    <expression name="defaultValue">"1800000" //30 min</expression>
                    <property name="isOptional">false</property>
                    <property name="allowNull">false</property>
                    <property name="isInput">true</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">skillName</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">skillId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">teamId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">startTimeMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">startTime12</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">durationMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">endTimeMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">endTime12</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="inputDataSets">
                <value>Skill DS</value>
                <value>Time Interval DS</value>
            </simple-property-list>
            <xml-property name="queryText"><![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<tns:joinedDataSet xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://schemas.actuate.com/birt/dataset_join.xsd" xmlns:tns="http://schemas.actuate.com/birt/dataset_join.xsd">
<tns:selectColumns>
<tns:Column>Skill DS::skillName</tns:Column>
<tns:Column>Skill DS::skillId</tns:Column>
<tns:Column>Skill DS::teamId</tns:Column>
<tns:Column>Time Interval DS::startTimeMillis</tns:Column>
<tns:Column>Time Interval DS::startTime12</tns:Column>
<tns:Column>Time Interval DS::durationMillis</tns:Column>
<tns:Column>Time Interval DS::endTimeMillis</tns:Column>
<tns:Column>Time Interval DS::endTime12</tns:Column>
</tns:selectColumns>
<tns:joins>
<tns:startingDataSet Index="0" name="Skill DS"/>
<tns:join>
<tns:type>inner</tns:type>
<tns:dataSet Index="1" name="Time Interval DS"/>
<tns:on>
<tns:condition>
<tns:leftColumn>Skill DS::joinColumn</tns:leftColumn>
<tns:rightColumn>Time Interval DS::joinColumn</tns:rightColumn>
<tns:operator>eq</tns:operator>
</tns:condition>
</tns:on>
</tns:join>
</tns:joins>
</tns:joinedDataSet>]]></xml-property>
        </derived-data-set>
        <script-data-set name="Demands Time Interval DS" id="13781">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">startTimeMillis</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">endTimeMillis</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">startTime12</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">endTime12</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">duration</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">demandsAmount</property>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">startTimeMillis</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">endTimeMillis</property>
                    <property name="analysis">measure</property>
                </structure>
                <structure>
                    <property name="columnName">startTime12</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">endTime12</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">duration</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">demandsAmount</property>
                    <property name="analysis">measure</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">skill</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <expression name="defaultValue" type="javascript">data["skillId"]</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">startTimeMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">endTimeMillis</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">startTime12</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">endTime12</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">duration</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">demandsAmount</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <method name="open"><![CDATA[demandTimeIntervalCount = 0;

var team = data["teamId"];
var skill = inputParams["skill"];
var reportData = reportContext.getGlobalVariable("reportData");

demandTimeIntervals = reportData[team][skill];
demandTimeIntervalIds = emlogis.helper.keySet(demandTimeIntervals);

var i = 1;]]></method>
            <method name="fetch"><![CDATA[if(demandTimeIntervalCount < demandTimeIntervalIds.length) {
	var timeInterval = demandTimeIntervals[demandTimeIntervalIds[demandTimeIntervalCount]];
	var demands = timeInterval.demands;
	
	row["startTimeMillis"] = timeInterval.startTimeMillis;
	row["startTime12"] = timeInterval.startTime12;
	row["endTimeMillis"] = timeInterval.endTimeMillis;
	row["endTime12"] = timeInterval.endTime12;
	row["durationMillis"] = timeInterval.durationMillis;
	
	var demandsAmount = 0;
	if(demands){
		for(var i = 0; i < demands.length; i++){
			if(demands[i].id) { demandsAmount++; }
		}
	}
	
	row["demandsAmount"] = demandsAmount;
	
	demandTimeIntervalCount++;
	return true;
}
return false;]]></method>
        </script-data-set>
        <script-data-set name="Test DS" id="13900">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">team</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">skill</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">measure</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">team</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">skill</property>
                    <property name="analysis">dimension</property>
                </structure>
                <structure>
                    <property name="columnName">measure</property>
                    <property name="analysis">dimension</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">team</property>
                    <property name="dataType">string</property>
                    <property name="position">1</property>
                    <expression name="defaultValue" type="javascript">data["teamId"]</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">skill</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <expression name="defaultValue" type="javascript">data["skillId"]</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">team</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">skill</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">measure</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <method name="open"><![CDATA[flag = false;

outerTeam = inputParams["team"];
outerSkill = inputParams["skill"];]]></method>
            <method name="fetch"><![CDATA[if(!flag) {
	row["team"] = outerTeam;
	row["skill"] = outerSkill;
	row["measure"] = 1;
	return true;
}
return false;]]></method>
        </script-data-set>
        <script-data-set name="TimeLine Cell DS" id="13940">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">demandAmount</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">demandAmount</property>
                    <property name="analysis">dimension</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">team</property>
                    <property name="dataType">string</property>
                    <property name="position">1</property>
                    <expression name="defaultValue" type="javascript">row._outer["teamId"]</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">skill</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <expression name="defaultValue" type="javascript">row._outer["skillId"]</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">timeInterval</property>
                    <property name="dataType">integer</property>
                    <property name="position">3</property>
                    <expression name="defaultValue" type="javascript">data["startTimeMillis_1"]</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">demandAmount</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <method name="open"><![CDATA[timeLineCellIsProcessed = false;

var team = inputParams["team"];
var skill = inputParams["skill"];
var timeInterval = inputParams["timeInterval"];
if(timeInterval == 0) {
	var i = 0;
}
var reportData = reportContext.getGlobalVariable("reportData");

demandTimeInterval = reportData[team][skill][timeInterval];

var i = 1;]]></method>
            <method name="fetch"><![CDATA[if(!timeLineCellIsProcessed) {
	var demands = demandTimeInterval.demands;
	var demandAmount = 0;
	if(demands){
		for(var i = 0; i < demands.length; i++){
			var demand = demands[i];
			if(demand.id) { demandAmount += demand.employeeCount; }
		}
	}
	
	row["demandAmount"] = demandAmount ? demandAmount : "";
	
	timeLineCellIsProcessed = true;
	return true;
}
return false;]]></method>
        </script-data-set>
    </data-sets>
    <cubes>
        <tabular-cube name="TimeLine DCube" id="13932">
            <property name="dimensions">
                <tabular-dimension name="TimeGroup" id="13933">
                    <property name="defaultHierarchy">NewTabularHierarchy</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy" id="13934">
                            <property name="levels">
                                <tabular-level name="startTimeMillis" id="13935">
                                    <property name="dataType">integer</property>
                                    <property name="columnName">startTimeMillis</property>
                                </tabular-level>
                                <tabular-level name="startTime12" id="13936">
                                    <property name="dataType">string</property>
                                    <property name="columnName">startTime12</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
            </property>
            <property name="measureGroups">
                <tabular-measure-group name="Summary Field" id="13937">
                    <property name="measures">
                        <tabular-measure name="durationMillis" id="13938">
                            <expression name="measureExpression" type="javascript">dataSetRow["durationMillis"]</expression>
                            <property name="dataType">integer</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
            </property>
            <property name="dataSet">Time Interval DS</property>
        </tabular-cube>
    </cubes>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">us-letter</property>
            <property name="orientation">landscape</property>
            <page-header>
                <grid name="Report header" id="13737">
                    <property name="marginLeft">auto</property>
                    <property name="marginBottom">0pt</property>
                    <property name="marginRight">auto</property>
                    <property name="width">100%</property>
                    <list-property name="boundDataColumns">
                        <structure>
                            <property name="name">reportTime</property>
                            <text-property name="displayName">Demand date</text-property>
                            <expression name="expression" type="javascript">"Demand date: " + Formatter.format(params["StartDate"], 'MM/dd/YYYY')</expression>
                            <property name="dataType">string</property>
                            <property name="allowExport">true</property>
                        </structure>
                        <structure>
                            <property name="name">reportName</property>
                            <text-property name="displayName">Report Name</text-property>
                            <expression name="expression" type="javascript">emlogis.current.reportName + ": "+emlogis.current.site.get("name")</expression>
                            <property name="dataType">string</property>
                            <property name="allowExport">true</property>
                        </structure>
                        <structure>
                            <property name="name">Selected teams</property>
                            <expression name="expression" type="javascript">"Selected teams: " + "&lt;u>" + emlogis.current.teams.getNames().join("&lt;u>&amp;nbsp;&amp;nbsp;&lt;u>") + "&lt;u>";</expression>
                            <property name="dataType">string</property>
                            <property name="allowExport">true</property>
                        </structure>
                    </list-property>
                    <column id="13738">
                        <property name="width">80%</property>
                    </column>
                    <column id="13739"/>
                    <row id="13740">
                        <cell id="13741">
                            <property name="style">emlogis-header-first</property>
                            <grid name="NewGrid11" id="13742">
                                <column id="13743"/>
                                <row id="13744">
                                    <cell id="13745">
                                        <property name="style">padding-05em</property>
                                        <data name="NewData111" id="13746">
                                            <property name="resultSetColumn">reportName</property>
                                        </data>
                                    </cell>
                                </row>
                            </grid>
                        </cell>
                        <cell id="13747">
                            <property name="style">emlogis-header-second</property>
                            <grid name="NewGrid2" id="13748">
                                <column id="13749"/>
                                <row id="13750">
                                    <cell id="13751">
                                        <property name="style">padding-05em</property>
                                        <data name="NewData21" id="13752">
                                            <property name="style">align-right</property>
                                            <property name="resultSetColumn">reportTime</property>
                                        </data>
                                    </cell>
                                </row>
                            </grid>
                        </cell>
                    </row>
                </grid>
            </page-header>
            <page-footer>
                <grid name="Report footer" id="13780" extends="common.Report footer">
                    <overridden-values>
                        <ref-entry baseId="13754" id="13754"/>
                        <ref-entry baseId="13755" id="13755"/>
                        <ref-entry baseId="13756" id="13756"/>
                        <ref-entry baseId="13757" id="13757"/>
                        <ref-entry baseId="13758" name="NewTextData111" id="13758"/>
                        <ref-entry baseId="13759" id="13759"/>
                        <ref-entry baseId="13760" name="NewGrid1111" id="13760"/>
                        <ref-entry baseId="13761" id="13761"/>
                        <ref-entry baseId="13762" id="13762"/>
                        <ref-entry baseId="13763" id="13763"/>
                        <ref-entry baseId="13764" id="13764"/>
                        <ref-entry baseId="13765" id="13765"/>
                        <ref-entry baseId="13766" id="13766"/>
                        <ref-entry baseId="13767" name="NewText211" id="13767"/>
                        <ref-entry baseId="13768" id="13768"/>
                        <ref-entry baseId="13769" name="NewAutoText211" id="13769"/>
                        <ref-entry baseId="13770" id="13770"/>
                        <ref-entry baseId="13771" name="NewText1111" id="13771"/>
                        <ref-entry baseId="13772" id="13772"/>
                        <ref-entry baseId="13773" name="NewAutoText1111" id="13773"/>
                    </overridden-values>
                </grid>
            </page-footer>
        </simple-master-page>
    </page-setup>
    <body>
        <list id="11098">
            <list-property name="userProperties">
                <structure>
                    <property name="name">__ac_group_collapse_level</property>
                    <property name="type">string</property>
                </structure>
            </list-property>
            <property name="dataSet">Teams Skills TimeInterval ShiftDemand Joined DS</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">teamName</property>
                    <text-property name="displayName">teamName</text-property>
                    <expression name="expression" type="javascript">dataSetRow["teamName"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">skillName</property>
                    <text-property name="displayName">skillName</text-property>
                    <expression name="expression" type="javascript">dataSetRow["skillName"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">startTimeMillis</property>
                    <text-property name="displayName">startTimeMillis</text-property>
                    <expression name="expression" type="javascript">dataSetRow["startTimeMillis"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">startTime12</property>
                    <text-property name="displayName">startTime12</text-property>
                    <expression name="expression" type="javascript">dataSetRow["startTime12"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">durationMillis</property>
                    <text-property name="displayName">durationMillis</text-property>
                    <expression name="expression" type="javascript">dataSetRow["durationMillis"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">endTimeMillis</property>
                    <text-property name="displayName">endTimeMillis</text-property>
                    <expression name="expression" type="javascript">dataSetRow["endTimeMillis"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">endTime12</property>
                    <text-property name="displayName">endTime12</text-property>
                    <expression name="expression" type="javascript">dataSetRow["endTime12"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">id</property>
                    <text-property name="displayName">id</text-property>
                    <expression name="expression" type="javascript">dataSetRow["id"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">startTime</property>
                    <text-property name="displayName">startTime</text-property>
                    <expression name="expression" type="javascript">dataSetRow["startTime"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">lengthInMin</property>
                    <text-property name="displayName">lengthInMin</text-property>
                    <expression name="expression" type="javascript">dataSetRow["lengthInMin"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">employeeCount</property>
                    <text-property name="displayName">employeeCount</text-property>
                    <expression name="expression" type="javascript">dataSetRow["employeeCount"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">shiftPatternId</property>
                    <text-property name="displayName">shiftPatternId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["shiftPatternId"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">teamId</property>
                    <text-property name="displayName">teamId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["teamId"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">skillId</property>
                    <text-property name="displayName">skillId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["skillId"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">dayOfWeek</property>
                    <text-property name="displayName">dayOfWeek</text-property>
                    <expression name="expression" type="javascript">dataSetRow["dayOfWeek"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">cdDate</property>
                    <text-property name="displayName">cdDate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["cdDate"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">maxEmployeeCount</property>
                    <text-property name="displayName">maxEmployeeCount</text-property>
                    <expression name="expression" type="javascript">dataSetRow["maxEmployeeCount"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Base</property>
                    <expression name="expression" type="javascript">"Base = xx.x"</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Net</property>
                    <expression name="expression" type="javascript">"Net = xx.x"</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Excess</property>
                    <expression name="expression" type="javascript">"Excess = xx.xx (xx%)"</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
            </list-property>
            <group id="11099">
                <property name="groupName">Team</property>
                <expression name="keyExpr" type="javascript">row["teamName"]</expression>
                <structure name="toc">
                    <expression name="expressionValue" type="javascript">row["teamName"]</expression>
                </structure>
                <property name="hideDetail">false</property>
                <property name="pageBreakBefore">always-excluding-first</property>
                <header>
                    <grid id="11161">
                        <column id="11162"/>
                        <row id="11163">
                            <cell id="11164">
                                <property name="style">padding-05em</property>
                                <data id="11100">
                                    <property name="style">emlogis-header-first</property>
                                    <property name="resultSetColumn">teamName</property>
                                </data>
                            </cell>
                        </row>
                    </grid>
                </header>
            </group>
            <group id="11101">
                <property name="groupName">Skill</property>
                <expression name="keyExpr" type="javascript">row["skillName"]</expression>
                <structure name="toc">
                    <expression name="expressionValue" type="javascript">row["skillName"]</expression>
                </structure>
                <property name="hideDetail">false</property>
                <header>
                    <grid id="11157">
                        <column id="11158"/>
                        <row id="11159">
                            <cell id="11160">
                                <property name="style">padding-05em</property>
                                <grid id="11103">
                                    <column id="11104">
                                        <property name="width">8%</property>
                                    </column>
                                    <column id="11105"/>
                                    <row id="11106">
                                        <cell id="11107">
                                            <property name="style">emlogis-header-second</property>
                                            <data id="11102">
                                                <property name="style">highlighted-text-dark</property>
                                                <property name="resultSetColumn">skillName</property>
                                            </data>
                                        </cell>
                                        <cell id="11108">
                                            <property name="colSpan">1</property>
                                            <property name="rowSpan">2</property>
                                            <extended-item extensionName="Crosstab" extensionVersion="3.7.0" id="13961">
                                                <property name="cube">TimeLine DCube</property>
                                                <property name="measures">
                                                    <extended-item extensionName="MeasureView" id="13972">
                                                        <property name="measure">durationMillis</property>
                                                        <property name="detail">
                                                            <extended-item extensionName="AggregationCell" id="13973">
                                                                <property name="aggregationOnColumn">TimeGroup/startTime12</property>
                                                                <list-property name="highlightRules">
                                                                    <structure>
                                                                        <property name="operator">eq</property>
                                                                        <expression name="testExpr" type="javascript">1</expression>
                                                                        <simple-property-list name="value1">
                                                                            <value type="javascript">1</value>
                                                                        </simple-property-list>
                                                                        <property name="style">border-right-left</property>
                                                                    </structure>
                                                                </list-property>
                                                                <property name="width">2%</property>
                                                                <property name="content">
                                                                    <grid id="13984">
                                                                        <property name="style">allign-center</property>
                                                                        <property name="dataSet">TimeLine Cell DS</property>
                                                                        <list-property name="boundDataColumns">
                                                                            <structure>
                                                                                <property name="name">demandAmount</property>
                                                                                <expression name="expression" type="javascript">dataSetRow["demandAmount"]</expression>
                                                                                <property name="dataType">string</property>
                                                                                <property name="allowExport">true</property>
                                                                            </structure>
                                                                        </list-property>
                                                                        <column id="13985"/>
                                                                        <row id="13986">
                                                                            <cell id="13987">
                                                                                <data id="13988">
                                                                                    <property name="resultSetColumn">demandAmount</property>
                                                                                </data>
                                                                            </cell>
                                                                        </row>
                                                                    </grid>
                                                                </property>
                                                                <property name="style">slim-fit</property>
                                                            </extended-item>
                                                        </property>
                                                        <property name="header">
                                                            <extended-item extensionName="CrosstabCell" id="13975">
                                                                <property name="style">empty-cell</property>
                                                            </extended-item>
                                                        </property>
                                                    </extended-item>
                                                </property>
                                                <property name="rows">
                                                    <extended-item extensionName="CrosstabView" id="13963"/>
                                                </property>
                                                <property name="columns">
                                                    <extended-item extensionName="CrosstabView" id="13979">
                                                        <property name="views">
                                                            <extended-item extensionName="DimensionView" id="13964">
                                                                <property name="dimension">TimeGroup</property>
                                                                <property name="levels">
                                                                    <extended-item extensionName="LevelView" name="NewLevel View" id="13965">
                                                                        <property name="level">TimeGroup/startTimeMillis</property>
                                                                        <property name="member">
                                                                            <extended-item extensionName="CrosstabCell" id="13966">
                                                                                <property name="content">
                                                                                    <grid id="13989">
                                                                                        <property name="style">align-left</property>
                                                                                        <column id="13990">
                                                                                            <property name="style">highlighted-text-light</property>
                                                                                        </column>
                                                                                        <row id="13991">
                                                                                            <property name="style">highlighted-text-small</property>
                                                                                            <cell id="13992">
                                                                                                <property name="style">slim-fit</property>
                                                                                                <data name="startTime12" id="13971">
                                                                                                    <property name="style">slim-fit</property>
                                                                                                    <property name="resultSetColumn">startTime12</property>
                                                                                                </data>
                                                                                            </cell>
                                                                                        </row>
                                                                                    </grid>
                                                                                </property>
                                                                                <list-property name="highlightRules">
                                                                                    <structure>
                                                                                        <property name="operator">eq</property>
                                                                                        <expression name="testExpr" type="javascript">1</expression>
                                                                                        <simple-property-list name="value1">
                                                                                            <value type="javascript">1</value>
                                                                                        </simple-property-list>
                                                                                        <property name="style">no-top-border</property>
                                                                                    </structure>
                                                                                </list-property>
                                                                                <property name="style">slim-fit</property>
                                                                            </extended-item>
                                                                        </property>
                                                                    </extended-item>
                                                                    <extended-item extensionName="LevelView" name="NewLevel View1" id="13968">
                                                                        <property name="level">TimeGroup/startTime12</property>
                                                                        <property name="member">
                                                                            <extended-item extensionName="CrosstabCell" id="13969">
                                                                                <property name="style">empty-cell</property>
                                                                            </extended-item>
                                                                        </property>
                                                                    </extended-item>
                                                                </property>
                                                            </extended-item>
                                                        </property>
                                                    </extended-item>
                                                </property>
                                                <property name="header">
                                                    <extended-item extensionName="CrosstabCell" id="13980">
                                                        <property name="style">empty-cell</property>
                                                    </extended-item>
                                                    <extended-item extensionName="CrosstabCell" id="13981">
                                                        <property name="style">empty-cell</property>
                                                    </extended-item>
                                                    <extended-item extensionName="CrosstabCell" id="13970">
                                                        <property name="style">empty-cell</property>
                                                    </extended-item>
                                                </property>
                                                <list-property name="boundDataColumns">
                                                    <structure>
                                                        <property name="name">startTimeMillis_1</property>
                                                        <expression name="expression">dimension["TimeGroup"]["startTimeMillis"]</expression>
                                                        <property name="dataType">integer</property>
                                                    </structure>
                                                    <structure>
                                                        <property name="name">startTime12</property>
                                                        <expression name="expression" type="javascript">var string = dimension["TimeGroup"]["startTime12"] + "";&#13;
string.indexOf(":") === -1 ? string : "";</expression>
                                                        <property name="dataType">string</property>
                                                    </structure>
                                                    <structure>
                                                        <property name="name">durationMillis_TimeGroup/startTime12</property>
                                                        <expression name="expression">measure["durationMillis"]</expression>
                                                        <property name="dataType">integer</property>
                                                        <simple-property-list name="aggregateOn">
                                                            <value>TimeGroup/startTime12</value>
                                                        </simple-property-list>
                                                        <property name="aggregateFunction">SUM</property>
                                                    </structure>
                                                    <structure>
                                                        <property name="name">durationMillis</property>
                                                        <expression name="expression">measure["durationMillis"]</expression>
                                                        <property name="dataType">integer</property>
                                                        <property name="aggregateFunction">SUM</property>
                                                    </structure>
                                                </list-property>
                                                <property name="style">no-borders</property>
                                            </extended-item>
                                        </cell>
                                    </row>
                                    <row id="11165">
                                        <cell id="11166">
                                            <data id="11154">
                                                <property name="style">highlighted-text-italic</property>
                                                <property name="resultSetColumn">Base</property>
                                            </data>
                                            <data id="11155">
                                                <property name="style">highlighted-text-italic</property>
                                                <property name="resultSetColumn">Net</property>
                                            </data>
                                            <data id="11156">
                                                <property name="style">highlighted-text-italic</property>
                                                <property name="resultSetColumn">Excess</property>
                                            </data>
                                        </cell>
                                    </row>
                                </grid>
                            </cell>
                        </row>
                    </grid>
                </header>
            </group>
        </list>
    </body>
</report>
